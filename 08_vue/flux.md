# Flux
2020.01.21  
리덕스, 뷰엑스 배우기 전에 짚고 넘어가기..

## 정의
애플리케이션의 상태를 저장할 수 있게 도와주는 중앙 집중식 저장소  
**예측 가능한** 애플리케이션 구축에 도움  

## MVC vs FLUX
### MVC패턴
1. 모델 : app의 데이터, 모델이 변경될 경우 컨트롤러와 뷰에 통보하여 컨트롤러와 뷰가 알고있는 데이터를 갱신할 수 있도록 함
2. 뷰 : 사용자에게 제공되는 UI 인터페이스
3. 컨트롤러 : 모델의 상태를 변경하는 대부분의 로직

컨트롤러가 모델의 데이터를 조회하거나 업데이트하는 역할  
모델의 변화를 뷰에 반영시킴. 사용자는 뷰를 통해 데이터를 입력

단점 : 하나의 컨트롤러가 여러개의 모델이나 뷰를 컨트롤 하는 것에 대한 제약이 없다  
애플리케이션이 커질 수록 복잡한 구조가 되기 쉬워짐

### Flux
MVC 패턴을 가진 에플리케이션이 커지면 커질수록 상태 관리 흐름이 너무 복잡해지는 것을 해결하는 패턴, **데이터 흐름이 양방향에서 단방향으로**
```shell
action => dispatcher => store => view => action...
// 액션으로 시작해서 디스패처, 스토어, 뷰순으로
```
뷰에서 사용자 액션이 일어나서 데이터를 업데이트해야 한다면, 액션부터 다시 시작해서 디스패처를 통해 스토어에 있는 데이터를 업데이트하고 뷰에 반영하게 됨. 단방향 데이터 흐름 구현  
중앙 집중되어 있는 저장소인 스토어의 데이터는 모든 컴포넌트가 접근할 수 있고 상태 공유하기도 쉬워짐  

## 구조
### 액션(Action)
액션은 타입과 페이로드를 가지고 있는 단순한 객체    
flux안에서 스토어를 변경하려면 디스패처를 통해서 업데이트가 이루어져야  
디스패처는 **액션을 통해** 실행시킬 수 있음
```javascript
// 액션 객체 - 액션 생성자를 통해 생성
{
  type: 'INCREMENT_COUNT',
  payload: {count : 1}
}
```

### 디스패처(Dispatcher)
Flux의 정중앙. 모든 데이터 흐름을 관리함  
디스패처는 **액션에 대한 콜백 함수를 제공**  
액션이 발생하면 스토어는 등록된 디스패처의 콜백 함수를 통해 발생한 액션에 대한 메시지를 전달받음  
액션 객체가 들어왔을 때 어떤 함수를 실행시켜야 하는지 알고 있음  

### 스토어(Store)
애플리케이션 내의 상태를 가지고 있음. 스토어에 있는 상태는 MVC 패턴에서의 모델  
스토어에 있는 상태를 변경하기 위해서는 반드시 액션 생성자가 액션을 생성한 후  
디스패처를 통해 **스토어에 상태 변경**을 요청  
상태 변경 요청은 디스패처를 통해서 해야 하며, **스토어에 들어있는 상태값을 직접 업데이트 할 수 없음**  
스토어에 등록된 상태가 변경되면 스토어는 상태가 변경되었다는 변경 이벤트를 통해 뷰에 새로운 상태를 전달하고 뷰가 스스로 업데이트를 하게 함

### 뷰(View)
MVC의 뷰와는 다르게 화면을 렌더링하는 역할 뿐 아니라, 컨트롤러의 역할도 가짐  
최상위 뷰는 스토어의 상태를 가져와서 자식 뷰에 분배하는 역할도 하기 때문에 컨트롤러 뷰라고 부르기도 함  
자식 뷰는 직접 스토어의 데이터를 받아오는 대신, 부모 뷰로부터 props를 사용해 데이터를 전달받음.  
vue나 react 컴포넌트들이 수행하는 역할

### 상태관리 맛집
flux 아키텍쳐를 따르는 프론트엔드 상태관리 라이브러리
1. [vuex](vuex.md)
2. [redux](../react/redux.md)

## reference
- [커피한잔 마시며 끝내는 Vue.js - Vuex](http://www.yes24.com/Product/Goods/76639545)