# posgteSQL

개괄적인 내용, 개념, 쿼리 작성법 대충 정리

## 개괄

- 오픈소스 DMBS
- 객체관계형 데이터베이스 시스템(ORDBMS)
- 관계형 DBMS의 기본적인 기능인 트랜잭션, ACID 지원함

## 내부 구조

- 클라이언트는 인터페이스 라이브러리를 통해 서버와의 연결을 요청하면
- Postmaster 프로세스가 서버와의 연결을 중계한다. 이후 클라이언트는 할당한 서버와의 연결을 통해 질의를 수행한다.
- 클라이언트로부터 질의 요청이 들어오면 구문 분석을 통해 parse tree를 생성하고 의미 분석 과정을 통해 새로운 트랜잭션을 시작하고 쿼리 트리를 생성한다.
- 이후 서버에 정의된 룰에 따라 쿼리 트리가 재생성되고 실행 가능한 여러 수행 계획 중 가장 최적화된 플랜 트리를 생성한다.
- 이를 수행하여 요청된 질의에 대한 결과를 클라이언트로 전달하게 된다
- 서버의 쿼리 수행 과정에서는 데이터베이스 내부의 시스템 카탈로그가 많이 사용되는데, 사용자가 함수나 데이터 타입은 물론 인덱스 접근 방식및 rule을 시스템 카탈로그에 직접 정의할 수 있음
- postgreSQL에는 이것이 기능을 새로 추가하거나 확장하는데 있어 중요한 포인트로 활용된다
- 데이터가 저장되는 파일들은 여러개의 페이지들도 구성되며, 하나의 페이지는 확장 가능한 slotted page 구조를 가진다.

![구조](https://d2.naver.com/content/images/2015/06/helloworld-227936-8.png)

## 시스템 명령어

### stop, start

```shell
brew services stop postgresql
brew services start postgresql
```

### 접속, 로그인, 유저 전환

```shell
#특정 아이디로 접속
psql -U postgres

#특정 디비로 접속
\c dbname
# 전체 데이터베이스 인스턴스 목록
\list
# 특정 테이블의 상세 정보를 조회 
\d
#전체 유저 목록
\du
# 현재 접속한 DB 인스턴스의 릴레이션들 조회
\dt
# 현재 접속한 DB 인스턴스의 function list 조회
\df
# 이전에 실행한 쿼리와 동일한 쿼리 실행
\g
# 전체 실행 내역 나열
\s
# 쿼리 결과 display 설정
\x, \a, \H
# 종료
\q
```

- 유저 이름과 제목이 같은 테이블이 하나는 있어야함

### DB, 릴레이션, 유저 만들기

### CRUD와 SELECT 예제


