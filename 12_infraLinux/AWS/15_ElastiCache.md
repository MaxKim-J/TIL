# ElasticCache

확장 가능한 분산 인메모리 캐시

## 설명

- 읽기 중심의 서비스나, 고속으로 데이터를 분석해야 하는 환경에 적합
- 데이터베이스의 부하를 줄이고자 할때, 대용량 분산 캐시 환경을 자체적으로 운영하기에는 부담이 있을때도 사용
- **인 메모리 캐시** : 모든 데이터를 RAM에만 올려놓고 사용하는 데이터베이스의 일종. 일반적인 데이터베이스는 데이터를 영구적으로 저장해 놓고, 필요한 데이터만 메모리에 읽어서 사용하고 이것이 인메모리 캐시와 데이터베이스의 가장 큰 차이점
- 인메모리 캐시는 모든 데이터를 메모리에 올려 놓는 것이 특징임. 디스크에 접근하지 않고 메모리로만 모든 처리를 하기 때문에 데이터 저장 및 검색 속도가 매우 빠름
- 단 데이터는 딱 메모리 크기(운영체제 사용량 제외하고)까지만 저장할 수 있음. 또한 메모리에만 저장되어 있기 때문에 서버의 전원 공급이 중단되면 데이터가 소멸함
- 서버 및 인터넷, 일반 컴퓨터 등에서 캐시라는 단어가 매우 자주 등장함. CloudFront에도 파일을 빠르게 전송하기 위해, 세계 각지에 에지 로케이션을 두고 파일을 캐시하며 웹 브라우저도 파일을 다시 받아오지 않기 위해 파일을 디스크에 캐시함. 인 메모리 캐시의 캐시도 비슷한 개념으로 사용함
- 보통 빠른 처리 속도를 위해 데이터베이스에 저장된 데이터 중 쿼리 결과나 자주 사용되는 데이터를(가령 서버세션 같은거를) 인 메모리 캐시에 임시로 저장함. 즉 캐시라는 단어 뜻 그대로 인메모리캐시는 주로 임시 저장소로 사용됨. 혹은 데이터베이스의 데이터가 아니더라도 디스크에 저장된 파일, 인터넷의 데이터, 기타 동적으로 생성되는 데이터 등 인메모리 캐시에 저장되는 데이터는 매우 다양.

## 지원 캐시 엔진

- MemCached : 분산 메모리 캐시 시스템
- **Redis** : 다양한 데이터 형식을 제공하는 키-값 데이터 저장소

## 효용

- 엘라스티캐시를 사용하면 Memcached 클러스터를 손쉽게 생성하고 확장할 수 있음. Memcached 클러스터는 리전의 가용 영역 별로 생성할 수 있고, Memcached 클러스터는 노드를 계속 추가할수록 데이터를 저장할 수 있는 공간이 늘어남 => 가용영역 안에서 노드를 계속 늘리면 늘린만큼 사용이 가능
- Redis를 쓸 경우에는 Memcached와 달리 클러스터를 구성할 수 없음. 따라서 노드를 추가한다고 해서 저장할 수 있는 전체 메모리 용량이 늘어나지는 않음. 데이터를 저장할 수 있는 메모리 용량은 각 캐시 노드가 제공하는 메모리 용량에 한함
- 다만 Redis는 스냅샷과 Read Replica를 지원함.

## 유형

인스턴스가 아니라 노드라고 부르는데, 캐시 노드는 여러 사양으로 나뉘어져 있음. RDS와의 차이점이라면, RDS는 생성된 DB 인스턴스의 인스턴스 클래스를 변경할 수 있지만, Elasti Cache는 생성된 캐시 노드의 캐시 노드 유형을 변경할 수 없음. 한번 생성되면 고정. 그리고 SSH로 접속이 불가능함

- 마이크로 : 가격이 가장 쌈. 213MB. 프리티어에서는 무료
- 표준 : 평균적
- 고급형 : 표준보다 vCPU 개수와 메모리 용량이 더 많음
- 고용량 메모리
- 고성능 CPU

## 예제

- ElastiCache에서 클러스터 생성 : 생성하면 엔드포인트 주소가 같이 생성되고, 보안 그룹 설정을 하면 해당 주소로 접속할 수 잇음
- 보안 그룹 설정 : 디폴트 값으로는 같은 default security group 설정 안에서만 접속이 허용되므로 외부에서는 접속이 불가능함. 따라서 캐시 노드 전용 보안 그룹을 생성하고 포트를 열어줘야 한다.
  - RDS의 데이터베이스 엔진은 AWS외부에서 접속이 허용되어 있지만, ElastiCache의 캐시엔진은 AWS 외부에서 접속할 수 없음. Security Group을 생성하여 모든 IP대역에 접속을 허용하더라도 동일한 VPC에 속한 EC2 인스턴스에서만 접속할 수 있음.
  - 포트는 11211번
- Memcached의 경우는 텔넷으로 접속이 가능함. 앞에서 생성한 EC2 인스턴스에 SSH로 접속 후 터미널에서 텔넷으로 캐시 노드에 접근이 가능함

  - 텔넷 클라이언트 : 인터넷이나 로컬 영역 연결에 쓰이는 네트워크 프로토콜의 하나. OSI 계층에서 응용 계층에 속하는 프로토콜이다 대충 SSH랑 위치가 비슷한 친구라고 생각하면 됨

  ```shell
  telnet examplememcached.o5nouc.0001.apne1.cache.amazonaws.com 11211
  ```

- 캐시 노드 추가 : 생성한 클러스터에 노드를 추가한다
- 사실... Redis같은걸 잘 몰라서 어캐 활용하는지 1도 감이 안온다...
